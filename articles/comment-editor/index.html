<!DOCTYPE html><html lang="zh-hans"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="preload" href="/component---src-layouts-index-jsx-586884a80dcf6d22090b.js" as="script"/><link rel="preload" href="/component---src-templates-post-jsx-e43738fb749a9be89f94.js" as="script"/><link rel="preload" href="/path---articles-comment-editor-44053b206a38d90112f7.js" as="script"/><link rel="preload" href="/app-85650f407218f83bf15d.js" as="script"/><link rel="preload" href="/commons-96c5d74cc0efb5012357.js" as="script"/><title data-react-helmet="true">封装一个基于Vue的留言评论编辑器组件 - 由作者孔令文发布于 2020-03-26</title><link data-react-helmet="true" rel="stylesheet" href="https://cdn.bootcss.com/github-markdown-css/2.10.0/github-markdown.min.css"/><meta data-react-helmet="true" name="keyword" content="frontend,html,css, javascript,vue"/><meta data-react-helmet="true" name="description" content="A technology sharing blog"/><meta data-react-helmet="true" itemProp="name" content="封装一个基于Vue的留言评论编辑器组件 - 由作者孔令文发布于 2020-03-26"/><meta data-react-helmet="true" itemProp="description" content="基本介绍 现在市面上有非常多的基于 Vue…"/><meta data-react-helmet="true" itemProp="image" content=""/><meta data-react-helmet="true" property="og:url" content="https://konglingwen94.github.io/articles/comment-editor/"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="封装一个基于Vue的留言评论编辑器组件 - 由作者孔令文发布于 2020-03-26"/><meta data-react-helmet="true" property="og:description" content="基本介绍 现在市面上有非常多的基于 Vue…"/><meta data-react-helmet="true" property="og:image" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="封装一个基于Vue的留言评论编辑器组件 - 由作者孔令文发布于 2020-03-26"/><meta data-react-helmet="true" name="twitter:description" content="基本介绍 现在市面上有非常多的基于 Vue…"/><meta data-react-helmet="true" name="twitter:image" content=""/><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css"/><style id="gatsby-inlined-css">.navbar-custom .nav-link,.navbar-custom .navbar-brand{font-weight:700;color:#fff}.navbar-custom .nav-item{margin:0 8px}.nav-link:hover{color:#ccc}.navbar-custom{transition:.3s;transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.navbar-custom.fixed-top{top:-60px}.navbar-custom.navbar--is-on-top{top:0}.navbar-custom.navbar--is-visible{top:0;background-color:hsla(0,0%,100%,.90196);box-shadow:0 0 40px rgba(0,0,0,.2)}.navbar-custom.navbar--is-visible .nav-link,.navbar-custom.navbar--is-visible .navbar-brand{color:#3d464d}.footer{padding:2em 0;margin-top:50px;font-size:12px;color:#999;background-color:#000}.footer ul{padding-left:0;list-style:none}.footer li{padding:24px 2em;line-height:1.8}.footer h2{font-size:14px;margin:0 auto 8px;font-weight:500}.footer a{color:#fff;cursor:pointer}.footer strong{font-weight:400}.tag{display:inline-block;border:1px solid #bfbfbf;margin-right:.6em;margin-bottom:.6em;border-radius:999em;font-size:12px;line-height:24px}.tag:last-child{margin-right:0}.tag__link{display:block;padding:0 1em;color:#bfbfbf;text-decoration:none}.tag:hover{border-color:#0056b3}.tag:hover .tag__link{color:#0056b3;text-decoration:none}.tag--full:hover{border-color:#0056b3;background-color:#0056b3}.tag--full:hover .tag__link{color:#fff;text-decoration:none}.tag--white{border-color:#fff}.tag--white .tag__link{color:#fff}.tag--white.tag--full:hover{border-color:hsla(0,0%,100%,.4);background-color:hsla(0,0%,100%,.4)}.tag--white.tag--full:hover .tag__link{color:#fff;text-decoration:none}.tag--custom-color .tag__link{color:#fff!important}.src-styles----post-module---post-heading---3XY_J{padding:150px 0;background:no-repeat 50%;background-color:gray;background-size:cover;background-image:linear-gradient(120deg,#2b488a,#ca3749)}.src-styles----post-module---post-heading__title---1-9YQ{margin:16px 0;font-size:54px;color:#fff}.src-styles----post-module---post-heading__meta---3katd{color:#fff}.src-styles----post-module---donation---1rPSR{padding:30px 0;border-top:1px solid #eee;border-bottom:1px solid #eee;text-align:center}.social-share{margin:24px 0}.src-styles----post-module---pager---3ag2f{margin-top:32px}.src-styles----post-module---pager__item---vNI-Q{display:block;padding:16px 24px;font-size:14px;border:1px solid #ddd;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,SimSun,sans-serif;line-height:1.6;text-transform:uppercase;letter-spacing:1px;color:#404040;background-color:#fff}.src-styles----post-module---pager__item---vNI-Q:hover{color:#404040;background:#eceeef;text-decoration:none}.src-styles----post-module---pager__title---2ZGsj{font-weight:700}.src-styles----post-module---pager__tips---R2YkG{margin:0;color:gray}.src-styles----post-module---pager__item--disabled---XSQC6{color:#818a91;cursor:not-allowed;background-color:#fff}.src-styles----post-module---pager__item--disabled---XSQC6:hover{color:#818a91;background-color:#fff}.markdown-body .gatsby-highlight{position:relative;padding-top:38px;border-radius:6px;background-color:#21252b}.markdown-body .gatsby-highlight:before{position:absolute;top:0;left:0;float:left;width:100%;height:38px;content:attr(rel);padding:0 80px;line-height:38px;font-size:16px;font-family:Source Sans Pro,sans-serif;font-weight:700;text-indent:15px;color:#fff}.markdown-body .gatsby-highlight:after{position:absolute;top:0;left:20px;width:12px;height:12px;content:" ";margin-top:13px;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;border-radius:50%;background:#fc625d}.markdown-body .gatsby-highlight pre{background-color:#2d2d2d!important;color:#ccc;counter-reset:line-number -1}.markdown-body{margin:48px 0}.markdown-body p{line-height:28px;text-align:justify;color:#3e3e3e}.markdown-body.zh,.markdown-body.zh-cmn-Hans,.markdown-body.zh-cn{font-family:Helvetica Neue,Helvetica,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif}.intro-header{padding:150px 0;margin-bottom:32px;background:no-repeat 50%;background-size:cover;background-image:linear-gradient(120deg,#2b488a,#ca3749)}.intro-header__site-heading{font-size:80px;color:#fff}.intro-header__subheading{font-size:18px;color:#fff}.intro-header--small{padding:80px 0}.intro-header--small .intro-header__site-heading{font-size:48px}.section{border-bottom:1px solid rgba(0,0,0,.10196);margin-bottom:24px}.section:last-child{border-bottom:none}.section__title{padding-bottom:8px;font-size:16px;font-weight:700;text-transform:uppercase;color:gray}.section__title a{color:gray;text-decoration:none}.section__body{padding-bottom:16px}.short-about__avatar{width:100%;height:auth}.short-about__intro{margin:16px 0;font-size:14px;color:#bfbfbf}.sns{margin-bottom:0}.sns__link{color:#bfbfbf}.friend-links{margin:0}.friend-links__link{font-size:14px;color:#bfbfbf}.tagCloud{margin:32px 0}.post{padding:24px 8px;border-bottom:1px solid rgba(0,0,0,.10196)}.post__link{display:block}.post__link:hover{text-decoration:none}.post__link:hover .post__title{color:#366df0}.post__title{margin-bottom:.6em;font-size:26px;line-height:1.2;color:#3d464d}.post__title:hover{color:#366df0}.post__content-preview{font-size:14px;text-align:justify;color:#a3a3a3}.post__meta{margin-top:8px;margin-bottom:0;font-size:14px;color:#a3a3a3}.post--small .post__title{font-size:18px}.post--succinct .post__content-preview{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.post--succinct .post__meta{display:none}.post--succinct .post__link:hover .post__content-preview,.post--succinct .post__link:hover .post__title{color:#366df0}.post-block__heading{font-size:20px;color:#0085a1}.post-block__title{margin-left:6px;font-weight:300;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,SimSun,sans-serif;line-height:1.7}.post-block__body{margin-left:16px;margin-bottom:24px}</style></head><body><div id="___gatsby"><div data-reactroot=""><nav class="navbar navbar-expand-sm fixed-top navbar-custom navbar--is-on-top"><div class="container"><div class="collapse navbar-collapse justify-content-between"><a class="navbar-brand" href="/">首页</a><ul class="nav navbar-nav navbar-right text-uppercase"><li class="nav-item"><a class="nav-link" href="/categories/">categories</a></li><li class="nav-item"><a class="nav-link" href="/tags/">Tags</a></li><li class="nav-item"><a class="nav-link" href="/about">about</a></li><li class="nav-item"><a class="nav-link" href="https://github.com/konglingwen94" target="_blank">GitHub</a></li></ul></div></div></nav><div><div class="src-styles----post-module---post-heading---3XY_J"><div class="container"><div class="row justify-content-md-center"><div class="col-10"><div class="tags ghost-tags"><div class="tag tag--full tag--white"><a class="tag__link" href="/tags#轮子">轮子</a></div></div><h1 class="src-styles----post-module---post-heading__title---1-9YQ">封装一个基于Vue的留言评论编辑器组件</h1><p class="src-styles----post-module---post-heading__meta---3katd">孔令文<!-- --> · <!-- -->2020-03-26</p></div></div></div></div><div class="container"><div class="row justify-content-md-center"><div class="col-10"><article class="markdown-body undefined"><h2>基本介绍</h2>
<p>现在市面上有非常多的基于 Vue 的组件库，但是看了好多都没有发现有关留言评论的组件，这对于想做一些文章信息展示类的项目可就显得棘手了，因为有太多的页面需要这个功能了，难道我们需要重复的去写（复制粘贴）这些代码吗？对于现在模块化体系逐渐完善的前端工程项目来说，一次性封装一个通用功能的组件式非常有必要的，那现在我们就去封装这样一个组件吧！</p>
<h2>必备技术（Vue）</h2>
<p>由于封装的组件式基于 Vue 的，所以这就要求我们需要掌握 Vue 的一些知识才行（Vue 小白建议先去官方文档阅读相关知识:grinning:），而对于有 Vue 基本功的同学可以通过封装这样一个功能完善的组件来加深对 Vue 组件化编程的理解。现在就让我们来实现这个组件的封装吧</p>
<h2>必不可少的文本输入框</h2>
<p>我们知道原生的 HTML 元素只有表单元素可以输入文本，但是这些元素默认情况下在不同的浏览器中渲染的样式各不相同，而且不支持输入有格式的文本，所以我们有必要用 Div 元素模拟一个具有格式化文本功能的输入框。</p>
<p>怎么才能使 Div 也能输入文字呢，这里就要说到一个 HTML5 的新属性"contenteditable"了。这个属性值是个布尔类型，给标签元素添加上这个属性且设置其属性值为 true 的话（默认不设置浏览器解析为 true），现在这个元素就是一个可编辑其内容的元素，用户就可以像使用表单元素一样来使用它了，现在让我们用代码来演示一下</p>
<div class="gatsby-highlight">
      <pre class="language-html"><code class="language-html">&lt;!-- 这里只演示主要代码 --&gt;

&lt;style&gt;
.inputBox{
  border:1px solid;
  height:200px;
  width:400px;
}
&lt;/style&gt;


&lt;div class=&quot;inputBox&quot; contenteditable=&quot;true&quot;&gt;我是可以被编辑的元素&lt;/div&gt;</code></pre>
      </div>
<p>页面实际的效果是这样的
<img src="https://github.com/konglingwen94/comment-message-editor/blob/master/screenshots/1.gif?raw=true" alt="封装一个留言评论编辑器组件"></p>
<p>至此一个可以输入文字的输入框我们就实现了，然后你还可以给它加上一些其他的样式使它更完善，这里就不在演示了。</p>
<h2>封装输入框组件</h2>
<p>为了更好的代码逻辑抽离以及后期的组件可维护性，我们把编辑器输入框的部分单独抽离为一个组件进行封装使用。有了前面的知识铺垫，封装这样一个组件也就很容易上手了，具体是怎么实现的我们直接看代码吧！</p>
<div class="gatsby-highlight">
      <pre class="language-html"><code class="language-html">&lt;!-- input-box.vue --&gt;
&lt;template&gt;
  &lt;div class&gt;
    &lt;div type=&quot;text&quot; class=&quot;input-box-wrapper&quot;&gt;
      &lt;div
        :class=&quot;[&#39;content&#39;,{focused},type]&quot;
        ref=&quot;richText&quot;
        v-on=&quot;listeners&quot;
        v-bind=&quot;$attrs&quot;
        :contenteditable=&quot;contenteditable&quot;
      &gt;&lt;/div&gt;
      &lt;div class=&quot;append-wrapper&quot;&gt;
        &lt;slot name=&quot;append&quot;&gt;&lt;/slot&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  name: &#39;input-box&#39;,
  data() {
    return {
      contenteditable: true
    }
  },
  computed: {
    listeners() {
      return Object.assign(
        {},
        this.$listeners,
        {
          input: function(e) {
            const inputContent =
              this.contentType === &#39;plain&#39;
                ? e.target.textContent
                : e.target.innerHTML
            this.$emit(&#39;input&#39;, inputContent)
          }.bind(this)
        }
      )
    }
  },
  props: {
    focused: {
      type: Boolean,
      default: false
    },
    contentType: {
      type: String,
      default: &#39;plain&#39;,
      validator(value) {
        return [&#39;plain&#39;, &#39;rich&#39;].includes(value)
      }
    },
    type: {
      type: String,
      default: &#39;text&#39;,
      validator(value) {
        return [&#39;text&#39;, &#39;textarea&#39;].includes(value)
      }
    },
    rows: Number
  },
  methods: {
    focus() {
      this.$refs.richText.focus()
    }
  }
}
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
.input-box-wrapper {
  position: relative;

}
.content {
  max-height: 5em;
  overflow: auto;
  &amp;::-webkit-scrollbar {
    width: 0;
  }
  &amp;.textarea {
    min-height: 2.7em;
  }
  &amp;.text {
    min-height: 1.2em;
  }
  &amp;:empty:before {
    content: attr(placeholder);
    color: #ccc;
    position: absolute;
    left: 10px;
    top: 7px;
  }
  &amp;.focused {
    border: #66b1ff 1px solid;
    cursor: text;
  }
  &amp;:focus {
    outline: none;
  }
  border: 1px solid #ccc;
  border-radius: 3px;
  padding: 7px 10px;
  padding-right: 30px;
  position: relative;
}
.append-wrapper {
  position: absolute;
  right: 1px;
  top: 1px;
  bottom: 1px;
  display: flex;
  cursor: pointer;
  align-items: center;
}
&lt;/style&gt;</code></pre>
      </div>
<p>实际的组件效果是这样的 <br></p>
<p><img src="https://github.com/konglingwen94/comment-message-editor/blob/master/screenshots/2.gif?raw=true" alt="封装一个留言评论编辑器组件"></p>
<p>至此一个用 Div 元素模拟后的文本输入框组件我们就做好了。</p>
<blockquote>
<p>备注：完整的 input-box 组件代码来自开源项目<a href="https://github.com/konglingwen94/comment-message-editor/blob/master/src/components/input-box.vue">comment-message-editor</a></p>
</blockquote>
<h2>丰富的表情符号选择器组件（:smile:）</h2>
<p>当我们在给一篇文章或者一个评论留言的时候混合使用文字和表情符号能使我们的语言更简练，同时也更有表达力。那为什么要封装符号选择器组件呢？答案是：在日益复杂的前端工程化环境中，所有将来可被复用或者需要扩展维护的功能模块面前，我们都需要把它抽离出来，这样以后不论是更改某一处的代码还是增加新的功能我们都能够很好的去维护并提交。这里顺便也把组件的源代码贴出来共大家平时做同类型的功能时可以参考。</p>
<blockquote>
<p>代码来自开源项目<a href="https://github.com/konglingwen94/comment-message-editor/blob/master/src/components/emoji-picker.vue">comment-editor</a></p>
</blockquote>
<div class="gatsby-highlight">
      <pre class="language-html"><code class="language-html">&lt;!-- emoji-picker.vue --&gt;

&lt;template&gt;
  &lt;div
    @keyup.esc=&quot;hidePicker&quot;
    ref=&quot;container&quot;
    class=&quot;emoji-wrapper&quot;
    hidefocus=&quot;true&quot;
    v-on=&quot;handleMouse()&quot;
  &gt;
    &lt;span class=&quot;emoji-button&quot; @click.stop=&quot;togglePickerVisibility&quot;&gt;
      &lt;img
        :class=&quot;{inactive:!pickerVisible}&quot;
        class=&quot;button-icon&quot;
        src=&quot;../emoji/icon.svg&quot;
        width=&quot;20&quot;
        height=&quot;20&quot;
        alt
      /&gt;
      &lt;span v-if=&quot;buttonTextVisible&quot; class=&quot;button-text&quot;&gt;表情&lt;/span&gt;
    &lt;/span&gt;
    &lt;ul :class=&quot;[&#39;emoji-picker&#39;,pickerPosition]&quot; v-if=&quot;pickerVisible&quot;&gt;
      &lt;li v-for=&quot;(url,key) in files&quot; :key=&quot;key&quot; class=&quot;emoji-picker-item&quot;&gt;
        &lt;img class=&quot;emoji-icon&quot; @click=&quot;handlerSelect&quot; width=&quot;20&quot; height=&quot;20&quot; :src=&quot;url&quot; alt /&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
const path = require(&#39;path&#39;)
const requireEmoji = require.context(&#39;../emoji&#39;)
let files = requireEmoji.keys()
export default {
  data() {
    return {
      pickerVisible: false,
      files: files.map(url =&gt; require(`../emoji/${url.slice(2)}`))
    }
  },
  props: {
    buttonTextVisible: {
      type: Boolean,
      default: true
    },
    triggerPick: {
      tyep: String,
      default: &#39;hover&#39;,
      validator(value) {
        return [&#39;hover&#39;, &#39;click&#39;].includes(value)
      }
    },
    pickerPosition: {
      type: String,
      default: &#39;right&#39;,
      validator(value) {
        return [&#39;left&#39;, &#39;middle&#39;, &#39;right&#39;].includes(value)
      }
    }
  },
  watch: {
    pickerVisible(newValue) {
      newValue ? this.$emit(&#39;activated&#39;) : this.$emit(&#39;inactivated&#39;)
    }
  },
  mounted() {
    const docHandleClick = (this.docHandleClick = e =&gt; {
      if (!this.$refs.container.contains(e.target)) {
        this.hidePicker()
      }
    })
    const handleKeyup = (this.handleKeyup = e =&gt; {
      if (e.key === &#39;Escape&#39;) {
        this.hidePicker()
      }
    })
    document.addEventListener(&#39;click&#39;, docHandleClick)
    document.addEventListener(&#39;keyup&#39;, handleKeyup)
  },
  destroyed() {
    document.removeEventListener(&#39;click&#39;, this.docHandleClick)
    document.removeEventListener(&#39;click&#39;, this.handleKeyup)
  },
  methods: {
    handlerSelect(e) {
      this.$emit(&#39;selected&#39;, e)
    },
    hidePicker() {
      this.pickerVisible = false
    },
    togglePickerVisibility() {
      if (this.triggerPick === &#39;click&#39;) {
        this.pickerVisible = !this.pickerVisible
      }
    },
    handleMouse() {
      const mouseenter = function() {
        this.pickerVisible = true
      }.bind(this)
      const mouseleave = function() {
        this.pickerVisible = false
      }.bind(this)
      if (this.triggerPick === &#39;hover&#39;) {
        return {
          mouseenter,
          mouseleave
        }
      } else {
        return {}
      }
    }
  }
}
&lt;/script&gt;
&lt;style scoped &gt;
ul,
li {
  list-style: none;
  margin: 0;
}
&lt;/style&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
.emoji-picker {
  display: flex;
  flex-wrap: wrap;
  width: 300px;
}
.emoji-picker-item {
  margin: 4px;
  cursor: pointer;
  img {
    user-select: none;
  }
}
.emoji-wrapper {
  position: relative;
  display: inline-block;
  z-index: 10000;
}
.emoji-button {
  font-size: 14px;
  cursor: pointer;
  user-select: none;
  .button-icon {
    &amp;.inactive {
      filter: grayscale(100%);
    }
  }
  &amp;:hover {
    color: #027fff;
  }
  .button-text {
    vertical-align: super;
  }
}
.emoji-picker {
  background: #fff;
  box-shadow: #ccc 1px 1px 7px;
  border-radius: 5px;
  padding: 10px;
  display: flex;
  position: absolute;
  &amp;.left {
    right: 0;
  }
  &amp;.middle {
    left: 50%;
    transform: translateX(-50%);
  }
}
&lt;/style&gt;</code></pre>
      </div>
<h2>组装编辑器入口组件</h2>
<p>我们有了输入框组件和表情符号选择器组件，接下来只要把他们按一定的使用方式组合起来，我们的评论编辑器组件就大功告成了。废话不多说让我们看代码吧</p>
<blockquote>
<p>源代码来自开源项目<a href="https://github.com/konglingwen94/comment-message-editor/blob/master/src/main.vue">comment-message-editor</a></p>
</blockquote>
<div class="gatsby-highlight">
      <pre class="language-html"><code class="language-html">&lt;!-- main.vue --&gt;

&lt;template&gt;
  &lt;div class=&quot;comment-editor&quot; ref=&quot;container&quot;&gt;
    &lt;div class=&quot;input-wrapper&quot; :class=&quot;{inline}&quot;&gt;
      &lt;input-box
        ref=&quot;inputBox&quot;
        :type=&quot;inline?&#39;text&#39;:&#39;textarea&#39;&quot;
        content-type=&quot;rich&quot;
        :rows=&quot;2&quot;
        @focus=&quot;onInputFocus&quot;
        @blur=&quot;onInputBlur&quot;
        @keyup.enter.ctrl.exact.native=&quot;handlerSubmit&quot;
        v-model=&quot;inputContent&quot;
        :placeholder=&quot;&#39;placeholder&#39;&quot;
        :focused=&quot;showInlineButton&quot;
        class=&quot;input-box&quot;
      &gt;
        &lt;div v-if=&quot;inline&quot; :class=&quot;[&#39;input-append&#39;,{hasbg:!showInlineButton}]&quot; slot=&quot;append&quot;&gt;
          &lt;emoji-picker
            ref=&quot;emojiPicker&quot;
            trigger-pick=&quot;click&quot;
            @activated=&quot;inputBoxFocused=true&quot;
            @selected=&quot;handlerEmojiSelected&quot;
            picker-position=&quot;left&quot;
            :button-text-visible=&quot;false&quot;
          &gt;&lt;/emoji-picker&gt;
        &lt;/div&gt;
      &lt;/input-box&gt;
      &lt;transition name=&quot;button&quot; &gt;
        &lt;div
          @click=&quot;handlerSubmit&quot;
          class=&quot;submit-button inline&quot;
          :disabled=&quot;!inputContent&quot;
          ref=&quot;button&quot;
          v-show=&quot;showInlineButton &amp;&amp; inline&quot;
        &gt;{{buttonText}}&lt;/div&gt;
      &lt;/transition&gt;
    &lt;/div&gt;
    &lt;div class=&quot;footer-action&quot; v-if=&quot;!inline&quot;&gt;
      &lt;emoji-picker
        trigger-pick=&quot;click&quot;
        @activated=&quot;$refs.inputBox.focus()&quot;
        @selected=&quot;handlerEmojiSelected&quot;
      &gt;&lt;/emoji-picker&gt;
      &lt;span class=&quot;submit-tiptext&quot;&gt;Ctrl + Enter&lt;/span&gt;
      &lt;div @click=&quot;handlerSubmit&quot; class=&quot;submit-button&quot; :disabled=&quot;!inputContent&quot;&gt;{{buttonText}}&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import InputBox from &#39;./components/input-box&#39;
import EmojiPicker from &#39;./components/emoji-picker&#39;
export default {
  name: &#39;comment-editor&#39;,
  components: { InputBox, EmojiPicker },
  data() {
    return {
      active: false,
      inputContent: &#39;&#39;,
      inputBoxFocused: false
    }
  },
  props: {
    buttonText: {
      type: String,
      default: &#39;提交&#39;
    },
    inline: {
      type: Boolean,
      default: false
    }
  },
  computed: {
    showInlineButton() {
      return !!(this.inputBoxFocused || this.inputContent)
    }
  },
  destroyed() {
    document.removeEventListener(&#39;click&#39;, this.hideButton)
  },
  mounted() {
    document.addEventListener(&#39;click&#39;, this.hideButton)
  },
  methods: {
    focus(){
      this.$refs.inputBox.focus()
    },
    hideButton(e) {
      if (this.$refs.container.contains(e.target)) {
        return
      }
      if (!this.$refs.container.contains(e.target)) {
        this.inputBoxFocused = false
      }
    },
    onInputFocus(e) {
      this.inputBoxFocused = true
    },
    onInputBlur(e) {
      if (this.$refs.container.contains(e.target)) {
        return
      }
      this.inputBoxFocused = false
    },
    handlerSubmit(e) {
      if (e.target.hasAttribute(&#39;disabled&#39;)) {
        return
      }
      this.$emit(&#39;submit&#39;, this.inputContent)
    },
    handlerEmojiSelected(e) {
      this.$refs.inputBox.focus()
      const clonedNode = e.target.cloneNode(true)
      clonedNode.style.verticalAlign = &#39;text-top&#39;
      document.execCommand(&#39;insertHTML&#39;, false, clonedNode.outerHTML)
    }
  }
}
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
.input-wrapper {
  &amp;.inline {
    display: flex;
    .input-box {
      flex: 1;
      margin-right: 14px;
    }
  }
  .input-append {
    width: 30px;
    height: 100%;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    &amp;.hasbg {
      background: #eee;
    }
  }
}
.footer-action {
  margin-top: 10px;
  display: flex;
  align-items: center;
}
.submit-tiptext {
  margin-left: auto;
  margin-right: 4px;
  font-size: 14px;
  color: #ccc;
}
.submit-button {
  align-self:flex-end;
  transition:all 0.2s;
  background: #409eff;
  border-radius: 4px;
  display: inline-block;
  cursor: pointer;
  padding: 6px 10px;
  color: white;
  user-select: none;
&amp;.button-enter,&amp;.button-leave-to{
  // zoom:0;
  margin-left:-40px;
  transform:scale(0,0)
}
  &amp;[disabled] {
    cursor: not-allowed;
    background: #66b1ff;
  }
  &amp;:hover {
    background: #66b1ff;
  }
  &amp;:not([disabled]):active {
    background: #3a8ee6;
  }
}
&lt;/style&gt;</code></pre>
      </div>
<h2>组件效果预览</h2>
<p><img src="https://github.com/konglingwen94/comment-message-editor/blob/master/screenshots/1.gif?raw=true" alt="封装一个留言评论编辑器组件">
<img src="https://github.com/konglingwen94/comment-message-editor/blob/master/screenshots/2.gif?raw=true" alt="封装一个留言评论编辑器组件"></p>
<p>文章最后附上本项目的<a href="https://github.com/konglingwen94/comment-message-editor">仓库地址</a></p>
<p>备注：本文属于作者原创，转载请注明出处，谢谢！<br>
作者：孔令文</p></article><div class="src-styles----post-module---donation---1rPSR"><h3 class="mb-3">您的鼓励是作者写作最大的动力</h3><p>如果您认为本网站的文章质量不错，读后觉得收获很大，不妨请我喝杯咖啡，让我有动力继续写出高质量的文章。</p><a href="https://cdn-images-1.medium.com/max/1600/1*PZjwR1Nbluff5IMI6Y1T6g@2x.png" class="btn btn-primary mr-2" target="_blank">支付宝打赏</a></div><div class="social-share" data-disabled="diandian"></div><hr/><ul class="src-styles----post-module---pager---3ag2f row justify-content-between text-center list-inline"><li class="col list-inline-item"><a class="src-styles----post-module---pager__item---vNI-Q undefined" title="封装一个自己的轮播图组件（基于 Vue）" href="/articles/good-swiper/"><div class="src-styles----post-module---pager__title---2ZGsj">Previous</div><p class="src-styles----post-module---pager__tips---R2YkG">封装一个自己的轮播图组件（基于 Vue）</p></a></li><li class="col list-inline-item"><a class="src-styles----post-module---pager__item---vNI-Q undefined" title="如何手动实现DOM元素的Resize事件侦听器" href="/articles/element-resize-event-polyfill/"><div class="src-styles----post-module---pager__title---2ZGsj">Next</div><p class="src-styles----post-module---pager__tips---R2YkG">如何手动实现DOM元素的Resize事件侦听器</p></a></li></ul></div></div></div></div><footer class="footer"><div class="container"><div><ul class="row"><li class="col-md-3"><h2>友情链接</h2><div><a href="https://github.com/konglingwen94" target="_blank">GitHub</a></div><div><a href="https://www.zhihu.com/people/kong-ling-wen-55" target="_blank">FETalk</a></div></li><li class="col-md-3"><h2>Open Source</h2><div><a href="https://github.com/konglingwen94" target="_blank">konglingwen94.github.io</a></div><div><a href="https://github.com/konglingwen94/vue-music" target="_blank">vue-music</a></div><div><a href="https://github.com/konglingwen94/element-resize-event-polyfill" target="_blank">element-resize-event-polyfill</a></div><div><a href="https://github.com/konglingwen94/anydirectory" target="_blank">anydirectory</a></div><div><a href="https://github.com/konglingwen94/egg-nuxt-blog" target="_blank">egg-nuxt</a></div></li><li class="col-md-3"><h2>联系方式</h2><div><a href="javascript:;">Mail</a> - <!-- -->794430774@qq.com</div></li><li class="col-md-3"><h2>内容许可</h2><div>除特别说明外，本站所有内容均采用<!-- --> <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" target="_blank">署名-非商业性使用-禁止演绎 4.0 国际 (CC BY-NC-ND 4.0)</a> <!-- -->进行许可。</div></li></ul></div></div></footer></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-85650f407218f83bf15d.js","213130420965792":"component---src-templates-post-jsx-e43738fb749a9be89f94.js","162898551421021":"component---src-pages-404-js-95a1f313704a919edcae.js","144251824217401":"component---src-pages-about-jsx-a25b5d9428065f0a71aa.js","142542727794042":"component---src-pages-categories-jsx-878ebe776c503198a6a5.js","213534597649335":"component---src-pages-index-jsx-71fe515fc9d09c74b252.js","36530248567819":"component---src-pages-tags-jsx-0a1905a7f389a97ea16d.js","60335399758886":"path----a60750dfe0c706a2a72e.js","17444338437003":"path---articles-deep-clone-object-07876a50e158f3c4e3cf.js","217841663097299":"path---articles-es-3-call-apply-eca94e7a7b2a47258251.js","101446527181117":"path---articles-iterate-runtime-performance-943fc19779ad26d85ca0.js","90083593868317":"path---articles-message-tree-cf0a4c20d80cddad7bd2.js","225127983765984":"path---articles-good-swiper-e0b5785da8518c9f5036.js","213664192171304":"path---articles-comment-editor-44053b206a38d90112f7.js","170008255791881":"path---articles-element-resize-event-polyfill-0fbad59f3f2060ff5234.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","273950069227526":"path---about-133e7a0e8c0db33df1cc.js","30875753179511":"path---categories-696d0b5c6f7207a25b44.js","142629428675168":"path---index-a8ff25a0e2fbcc47c381.js","55702396619907":"path---tags-696d0b5c6f7207a25b44.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","79611799117203":"component---src-layouts-index-jsx-586884a80dcf6d22090b.js"}/*]]>*/</script><script>/*<![CDATA[*/["/commons-96c5d74cc0efb5012357.js","/app-85650f407218f83bf15d.js","/path---articles-comment-editor-44053b206a38d90112f7.js","/component---src-templates-post-jsx-e43738fb749a9be89f94.js","/component---src-layouts-index-jsx-586884a80dcf6d22090b.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>